# Integration Test Cases - Membership Management Module

## 1. View and Filter Membership Packages (5 test cases)

| Test Case ID              | Test Case Description                                               | Test Case Procedure                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Expected Results                                                                                                                                                                                              | Pre-conditions                                       |
| ------------------------- | ------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------- |
| TC-MEMBERSHIP-VIEW-001    | Verify Membership Management page UI elements are displayed correctly | 1. Navigate to membership management page (/quanlysancaulong/(private)/memberships)<br>2. Verify breadcrumb shows "Quản trị ứng dụng > Quản lý gói hội viên"<br>3. Verify "Lọc dữ liệu" search card is displayed<br>4. Verify table with columns: Tên gói, Giá, % Giảm, Thời hạn (ngày), Trạng thái, Ngày sửa đổi lần cuối, Người sửa đổi lần cuối<br>5. Verify "Tổng số gói" counter is displayed<br>6. Verify action buttons: "Thêm gói hội viên", "Tải lại"<br>7. Verify "Danh sách hội viên của gói đã chọn" section is displayed below | All UI elements are displayed correctly. Search form is visible with filter fields. Table structure is shown with required columns. Action buttons are visible and styled. Total membership count is displayed. User membership section is visible below. | User is logged in with admin/staff role              |
| TC-MEMBERSHIP-VIEW-002    | Verify membership list is loaded and displayed correctly              | 1. Navigate to membership management page<br>2. Wait for membership list to load<br>3. Verify table displays all membership packages<br>4. Verify each row shows: name, price (formatted with VN locale), discountPercent, durationDays, status with color coding (green for "Đang hoạt động", red for "Không hoạt động"), updated date/time, updated by user<br>5. Verify status colors are displayed correctly                                                                                      | Membership list loads successfully. All memberships appear in table with correctly formatted data. Price is formatted with thousand separators. Status colors are correct. No spinner after load.    | User is logged in. Membership data exists              |
| TC-MEMBERSHIP-VIEW-003    | Verify search membership by name and status                          | 1. Navigate to membership management page<br>2. Wait for membership list to load<br>3. Enter partial name in "Tên gói" field<br>4. Select status from "Trạng thái" dropdown (e.g., "Hoạt động")<br>5. Click "Tìm kiếm" button<br>6. Verify table shows only memberships matching both filters<br>7. Verify total count updates<br>8. Click "Reset" button<br>9. Verify all memberships are displayed         | Search filters work correctly. Table updates to show only matching memberships. Total count reflects filtered results. Reset clears all filters and shows all memberships.                             | User is logged in. Memberships with various data exist |
| TC-MEMBERSHIP-VIEW-004    | Verify expandable row to view membership details                      | 1. Navigate to membership management page<br>2. Wait for membership list to load<br>3. Click a membership row to expand<br>4. Verify expanded content shows: membership name, price (formatted), discountPercent, durationDays, status, description (or "-")<br>5. Verify action buttons: "Cập nhật thông tin", status change buttons ("Ngừng hoạt động" or "Kích hoạt")<br>6. Click row again to collapse | Row expands successfully. Expanded content shows all membership details correctly. Status buttons are visible based on current status. Row collapses on second click.                                           | User is logged in. Membership data exists              |
| TC-MEMBERSHIP-VIEW-005    | Verify reload data functionality and total count                    | 1. Navigate to membership management page<br>2. Wait for data to load<br>3. Note total membership count<br>4. Click "Tải lại" button<br>5. Observe loading state<br>6. Wait for data to reload<br>7. Verify table refreshes and total count updates                                                                                                                                                                                                                                                                                                  | Reload triggers data refresh. Loading state appears during fetch. Table and count update with latest data.                                                                                                    | User is logged in. Network available                 |

## 2. Create Membership Package (5 test cases)

| Test Case ID                | Test Case Description                                              | Test Case Procedure                                                                                                                                                                                                                                                                                                                                                                                                                              | Expected Results                                                                                                                                     | Pre-conditions                                |
| --------------------------- | ------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------- |
| TC-MEMBERSHIP-CREATE-001   | Verify Create Membership Drawer opens and displays correctly         | 1. Click "Thêm gói hội viên" button<br>2. Verify Create Membership Drawer opens<br>3. Verify form fields: Tên gói (required), Giá (required), % giảm giá khi đặt sân (required), Thời hạn (ngày) (required), Mô tả quyền lợi (optional), Trạng thái (default "Active")<br>4. Verify "Thêm gói" and "Hủy" buttons are visible | Drawer opens with correct title. All form fields and action buttons are visible. Required fields are marked appropriately. Status defaults to "Active".                           | User is logged in with admin/staff role       |
| TC-MEMBERSHIP-CREATE-002   | Verify successful membership creation with all required fields       | 1. Open Create Membership Drawer<br>2. Enter valid membership name<br>3. Enter valid price (>= 0)<br>4. Enter discount percent (0-100)<br>5. Enter duration days (>= 1)<br>6. Enter description (optional)<br>7. Keep status as "Active" (default)<br>8. Click "Thêm gói" button<br>9. Wait for API response                                                                                                                       | Membership created successfully. Success message "Tạo gói hội viên thành công!" is shown. Drawer closes. Membership appears in list with correct data.     | User is logged in.                            |
| TC-MEMBERSHIP-CREATE-003   | Verify validation errors when required fields are empty or invalid | 1. Open Create Membership Drawer<br>2. Leave name empty and click "Thêm gói"<br>3. Verify error "Tên gói là bắt buộc"<br>4. Enter name, leave price empty<br>5. Verify error "Giá là bắt buộc"<br>6. Enter invalid discount percent (> 100)<br>7. Verify validation error<br>8. Enter invalid duration days (< 1)<br>9. Verify validation error                                       | Validation errors are displayed for empty or invalid required fields. Submission is blocked. No API call made.                                       | User is logged in                             |
| TC-MEMBERSHIP-CREATE-004   | Verify membership creation with Inactive status                        | 1. Open Create Membership Drawer<br>2. Fill all required fields<br>3. Select status "Không hoạt động" from dropdown<br>4. Click "Thêm gói" button<br>5. Wait for API response<br>6. Verify membership is created with status "Inactive"<br>7. Verify status column shows "Không hoạt động" in red                                                               | Membership is created with selected status. Status column shows correct status with appropriate color. Success message is displayed. | User is logged in. Valid image file available |
| TC-MEMBERSHIP-CREATE-005   | Verify cancel membership creation resets form                        | 1. Open Create Membership Drawer<br>2. Fill in all fields (required and optional)<br>3. Click "Hủy" button or close drawer<br>4. Verify drawer closes<br>5. Reopen Create Membership Drawer<br>6. Verify form is empty                                                                                                                                                  | Drawer closes successfully. Form is reset. Reopening drawer shows empty form. No data persists.               | User is logged in                             |

## 3. Update Membership Package (5 test cases)

| Test Case ID                | Test Case Description                                    | Test Case Procedure                                                                                                                                                                                                                                                                                                                                                                                                                         | Expected Results                                                                                                                                                                                                                    | Pre-conditions                     |
| --------------------------- | -------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------- |
| TC-MEMBERSHIP-UPDATE-001   | Verify Update Membership Drawer opens with pre-filled data | 1. Navigate to membership management page<br>2. Wait for membership list to load<br>3. Expand a membership row<br>4. Click "Cập nhật thông tin" button<br>5. Verify Update Membership Drawer opens<br>6. Wait for membership detail to load<br>7. Verify loading spinner is shown while fetching<br>8. Verify fields are pre-filled: name, price, discountPercent, durationDays, description, status | Drawer opens with correct title. Loading spinner is shown while fetching detail. All form fields are pre-filled with existing membership data. Ready for edit.                                  | User is logged in. Membership exists |
| TC-MEMBERSHIP-UPDATE-002   | Verify successful membership update                        | 1. Open Update Membership Drawer for a membership<br>2. Wait for data to load<br>3. Modify membership name<br>4. Update price<br>5. Change discount percent<br>6. Update duration days<br>7. Modify description<br>8. Change status<br>9. Click "Lưu thay đổi" button<br>10. Wait for API response                                                                                                                                                                  | Membership updated successfully. Success message "Cập nhật gói hội viên thành công!" is shown. Drawer closes automatically. Table refreshes to show updated information. Updated data is displayed correctly in table and expanded row. | User is logged in. Membership exists |
| TC-MEMBERSHIP-UPDATE-003   | Verify validation errors when updating with invalid data | 1. Open Update Membership Drawer<br>2. Wait for data to load<br>3. Clear name field<br>4. Enter invalid discount percent (> 100)<br>5. Enter invalid duration days (< 1)<br>6. Enter negative price<br>7. Click "Lưu thay đổi"<br>8. Verify validation errors are displayed                                                                                                                                                   | Validation blocks save. Error messages shown for invalid fields. No API call.                                                        | User is logged in. Membership exists |
| TC-MEMBERSHIP-UPDATE-004   | Verify updating membership status                   | 1. Open Update Membership Drawer<br>2. Wait for data to load<br>3. Verify current status is displayed<br>4. Change status from Active to Inactive (or vice versa)<br>5. Click "Lưu thay đổi"<br>6. Verify status is updated<br>7. Verify status column in table shows correct color                                                                                   | Current status is displayed correctly. Status can be changed. Membership is updated with new status. Success message is displayed. Status column shows updated status with correct color (green for Active, red for Inactive).  | User is logged in. Membership exists |
| TC-MEMBERSHIP-UPDATE-005   | Verify cancel update keeps original data                 | 1. Open Update Membership Drawer<br>2. Wait for data to load<br>3. Modify name, price, discountPercent, durationDays, and description<br>4. Change status<br>5. Click "Hủy" button or close drawer<br>6. Verify drawer closes<br>7. Expand membership row again<br>8. Click "Cập nhật thông tin" again<br>9. Verify original data is still displayed                                                         | Drawer closes successfully. Changes are not saved. Original membership data remains unchanged. Opening update drawer again shows original data. No modifications are persisted.                                                       | User is logged in. Membership exists |

## 4. Update Membership Status (3 test cases)

| Test Case ID                | Test Case Description                             | Test Case Procedure                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Expected Results                                                                                                                                                                                                                                                                                                              | Pre-conditions                                          |
| --------------------------- | ------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------- |
| TC-MEMBERSHIP-STATUS-001   | Verify change membership status to Inactive         | 1. Navigate to membership management page<br>2. Wait for membership list to load<br>3. Expand a membership row with status "Active"<br>4. Verify "Ngừng hoạt động" button is visible<br>5. Click "Ngừng hoạt động" button<br>6. Wait for API response<br>7. Verify membership status changes to "Không hoạt động" (red color)<br>8. Verify "Ngừng hoạt động" button is hidden, "Kích hoạt" button appears | Status is updated to "Inactive" successfully. Success message "Cập nhật trạng thái thành công" is displayed. Status column shows "Không hoạt động" in red. Button visibility is updated correctly. Table refreshes to show new status. Expanded row status is also updated. | User is logged in. Membership exists with status Active   |
| TC-MEMBERSHIP-STATUS-002   | Verify change membership status to Active           | 1. Navigate to membership management page<br>2. Wait for membership list to load<br>3. Expand a membership row with status "Inactive"<br>4. Verify "Kích hoạt" button is visible<br>5. Click "Kích hoạt" button<br>6. Wait for API response<br>7. Verify membership status changes to "Đang hoạt động" (green color)<br>8. Verify "Kích hoạt" button is hidden, "Ngừng hoạt động" button appears                                                                                                                     | Status is updated to "Active" successfully. Success message "Cập nhật trạng thái thành công" is displayed. Status column shows "Đang hoạt động" in green. Button visibility is updated correctly. Table refreshes to show new status. Expanded row status is also updated.            | User is logged in. Membership exists with status Inactive |
| TC-MEMBERSHIP-STATUS-003   | Verify status change updates table immediately | 1. Navigate to membership management page<br>2. Wait for membership list to load<br>3. Note current status of a membership in the table<br>4. Expand the membership row<br>5. Click status change button<br>6. Wait for API response<br>7. Verify status column in table is updated immediately<br>8. Verify status color is updated<br>9. Verify expanded row status is also updated                                                                                                                                                                                                                    | Status change updates table immediately. Status column shows new status. Status color is updated correctly. Expanded row status is synchronized. No page refresh is needed. Changes are reflected in real-time.                                                                                                                                         | User is logged in. Membership exists                      |

## 5. View User Memberships (5 test cases)

| Test Case ID                | Test Case Description                                   | Test Case Procedure                                                                                                                                                                                                                                                                                                                                                                                                                            | Expected Results                                                                                                                                   | Pre-conditions                                  |
| --------------------------- | ------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------- |
| TC-USERMEMBERSHIP-VIEW-001 | Verify user membership list displays when membership is selected              | 1. Navigate to membership management page<br>2. Wait for membership list to load<br>3. Click on a membership row to select it<br>4. Verify row is highlighted (blue background)<br>5. Verify "Danh sách hội viên của gói đã chọn" section displays below<br>6. Verify user membership table is shown<br>7. Verify table columns: ID, Khách hàng, Tên gói, Bắt đầu, Kết thúc, Kích hoạt, Trạng thái | Membership row is selected and highlighted. User membership section appears below. Table is displayed with correct columns. User memberships are loaded for selected membership.                                                                                             | User is logged in. Membership exists. User memberships exist for the membership     |
| TC-USERMEMBERSHIP-VIEW-002 | Verify user membership table displays data correctly | 1. Select a membership row<br>2. Wait for user membership list to load<br>3. Verify table displays all user memberships for selected membership<br>4. Verify each row shows: ID, customer name (or customerId), membership name (or membershipId), start date (formatted), end date (formatted), isActive status ("Đã kích hoạt" in green or "Chưa kích hoạt" in red), payment status ("Chờ thanh toán", "Đã thanh toán", "Đã hủy")<br>5. Verify dates are formatted correctly | User membership list loads successfully. All user memberships appear in table with correctly formatted data. Status colors are correct. Dates are displayed in YYYY-MM-DD HH:mm:ss format. | User is logged in. Membership selected. User memberships exist |
| TC-USERMEMBERSHIP-VIEW-003 | Verify expandable row to view user membership details             | 1. Select a membership row<br>2. Wait for user membership list to load<br>3. Click a user membership row to expand<br>4. Verify expanded content shows two tabs: "Thông tin cơ bản" and "Lịch sử thanh toán"<br>5. Verify "Thông tin cơ bản" tab shows: customer name, phone number, email, membership name, start date, end date, status (with color tag), isActive status<br>6. Verify "Lịch sử thanh toán" tab shows payment history table (if exists) or empty state<br>7. Verify "Xem QR" button is visible for "PendingPayment" status | Row expands successfully. Expanded content shows all user membership details correctly. Tabs are functional. Payment history is displayed if exists. QR button is visible for pending payment status.                              | User is logged in. Membership selected. User membership exists |
| TC-USERMEMBERSHIP-VIEW-004 | Verify "Thêm hội viên" button is disabled when no membership is selected | 1. Navigate to membership management page<br>2. Wait for membership list to load<br>3. Verify no membership row is selected<br>4. Verify "Thêm hội viên" button is disabled<br>5. Verify "Tải lại" button in user membership section is disabled<br>6. Click on a membership row to select it<br>7. Verify "Thêm hội viên" button becomes enabled<br>8. Verify "Tải lại" button becomes enabled | Buttons are disabled when no membership is selected. Buttons become enabled when a membership is selected. User can add memberships only after selecting a membership package.                                                                                   | User is logged in                               |
| TC-USERMEMBERSHIP-VIEW-005 | Verify reload user membership functionality             | 1. Select a membership row<br>2. Wait for user membership list to load<br>3. Note the number of user memberships displayed<br>4. Click "Tải lại" button in user membership section<br>5. Observe loading state<br>6. Wait for data to reload<br>7. Verify user membership table refreshes<br>8. Verify data is updated                                                                                                  | Reload triggers data refresh. Loading state appears during fetch. Table updates with latest data. User memberships are refreshed correctly.                              | User is logged in. Membership selected. Network available |

## 6. Create New User Membership (5 test cases)

| Test Case ID                  | Test Case Description                               | Test Case Procedure                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Expected Results                                                                                                                                                      | Pre-conditions                                       |
| ----------------------------- | --------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------- |
| TC-USERMEMBERSHIP-CREATE-001 | Verify Create User Membership Drawer opens and displays correctly            | 1. Select a membership row<br>2. Click "Thêm hội viên" button<br>3. Verify Create User Membership Drawer opens<br>4. Verify drawer title "Thêm hội viên cho gói" is displayed<br>5. Verify form fields: Khách hàng (required, DebounceSelect), Ghi chú (optional), Phương thức thanh toán (required, default "Bank")<br>6. Verify payment method options: "Chuyển khoản" (Bank), "Tiền mặt" (Cash)<br>7. Verify "Xác nhận" and "Hủy" buttons are visible | Drawer opens with correct title. All form fields and action buttons are visible. Customer select field is displayed with search functionality. Payment method selector is visible.          | User is logged in. Membership is selected                     |
| TC-USERMEMBERSHIP-CREATE-002 | Verify successful user membership creation with Bank payment                   | 1. Select a membership row<br>2. Click "Thêm hội viên" button<br>3. Select a customer from "Khách hàng" dropdown (using search if needed)<br>4. Enter note (optional)<br>5. Select payment method "Chuyển khoản"<br>6. Click "Xác nhận" button<br>7. Wait for API response<br>8. Verify success message "Tạo hội viên thành công"<br>9. Verify QR Payment Drawer opens automatically (if qrUrl exists)<br>10. Verify drawer closes<br>11. Verify user membership appears in list | User membership created successfully. Success message is displayed. QR Payment Drawer opens automatically if payment method is Bank and qrUrl exists. Drawer closes. New user membership appears in user membership table. | User is logged in. Membership selected. Customer exists. Payment method is Bank |
| TC-USERMEMBERSHIP-CREATE-003 | Verify successful user membership creation with Cash payment           | 1. Select a membership row<br>2. Click "Thêm hội viên" button<br>3. Select a customer from "Khách hàng" dropdown<br>4. Enter note (optional)<br>5. Select payment method "Tiền mặt"<br>6. Click "Xác nhận" button<br>7. Wait for API response<br>8. Verify success message "Tạo hội viên thành công"<br>9. Verify QR Payment Drawer does NOT open<br>10. Verify drawer closes<br>11. Verify user membership appears in list | User membership created successfully. Success message is displayed. QR Payment Drawer does not open for Cash payment. Drawer closes. New user membership appears in user membership table. | User is logged in. Membership selected. Customer exists. Payment method is Cash |
| TC-USERMEMBERSHIP-CREATE-004 | Verify validation error when customer is not selected           | 1. Select a membership row<br>2. Click "Thêm hội viên" button<br>3. Leave "Khách hàng" field empty<br>4. Select payment method<br>5. Click "Xác nhận" button<br>6. Verify validation error "Bắt buộc" is displayed<br>7. Verify submission is prevented | Validation error is displayed for empty customer field. Submission is blocked. No API call made. User can select customer and resubmit. | User is logged in. Membership selected |
| TC-USERMEMBERSHIP-CREATE-005 | Verify cancel user membership creation resets form | 1. Select a membership row<br>2. Click "Thêm hội viên" button<br>3. Select a customer<br>4. Enter note<br>5. Select payment method<br>6. Click "Hủy" button or close drawer<br>7. Verify drawer closes<br>8. Verify form is reset<br>9. Reopen drawer<br>10. Verify form is empty | Drawer closes successfully. Form is reset. Reopening drawer shows empty form. No data persists. | User is logged in. Membership selected |

